{{> page-header this }}

<div class="alert alert-warning">
  <p class="lead">
    <i class="fa fa-warning"></i> Espace réservé aux juges.
  </p>
</div>

<section>

  <header>

    <h2>Fiches de notation de {{user}}</h2>

  </header>

  <div class="alert alert-info">
    <p>
      Sélectionnez une catégorie pour voter sur chaque display en compétition.
    </p>
  </div>

  <ul class="nav nav-pills nav-stacked m-t-2" role="tablist">
    {{#each categories}}
    <li class="nav-item">
      <a data-toggle="tab" class="nav-link" href="#category_{{code}}" role="tab">
        <div class="row">
          <div class="col-xs-1 vote-status" data-category="{{code}}" >
            <i class="vote-pending  fa fa-circle-o"></i>
            <i class="vote-complete fa fa-check-circle"></i>
          </div>
          <div class="col-xs-1">{{code}}</div>
          <div class="col-xs-9 col-md-7">{{label}}</div>
          <div class="col-xs-3 col-xs-offset-1 col-md-offset-0">{{group}}</div>
        </div>
      </a>
    </li>  
    {{/each}}
  </ul>

  <div class="alert alert-info m-t-1 m-b-1">
    <p>
      Donnez une note à chaque display. Lorsque chaque display aura une note 
      un cercle coché <i class="fa fa-check-circle"></i> sera indiqué en vis à vis 
      de la catégorie.
    </p>
  </div>
  
  <div class="tab-content">
    {{#each categories}}
    
    <article id="category_{{code}}" class="tab-pane" role="tabpanel">
      {{#unless submitted}}
      <div class="card alert alert-info">
        <div class="card-block">
          <p>
            Aucun display n'a été proposé pour cette catégorie du concours.
          </p>
        </div>
      </div>
      {{/unless}}
    
      <table class="table table-striped">
        <thead class="thead-inverse">
          <tr>
            <th>Display</th>
            <th>Votre note</th>
          </tr>
        </thead>

        <tbody>
          {{#each submitted}}
          <tr>
            <td>
              <div class="row">
                <span class="col-xs-3">
                  <var class="">{{accessKey}}</var>
                </span>
                <span class="col-xs-9">
                    <li>{{itemName}} [{{categoryCode}}]</li>
                </span>
              </div>
            </td>

            <td>
              <select name="note_{{../code}}_{{accessKey}}" 
                      data-category="{{../code}}" 
                      data-display="{{accessKey}}" 
                      class="fmj-note form-control form-control-lg" >
                <option value="" disabled="disabled" selected="selected">Choisir une note</option>
                {{#each ../../notes}}
                <option value="{{this}}">{{this}}</option>
                {{/each}}
              </select>
            </td>
          </tr>
          {{/each}}

        </tbody>
      </table>
    </article>
    {{/each}}
  </div>


  <div class="fmj-action-bar">
    <div class="row">
      <div class="col-xs-12 col-md-7 m-t-1 m-b-1">
        Vous pouvez envoyer votre vote autant de fois que nécessaire jusqu'à
        la cloture du concours.
      </div>

      <div class="col-xs-12 col-md-5  m-t-1 m-b-1 text-xs-right">
        <button id="submitVote" class="btn btn-primary btn-lg" type="button">
          <i class="fa fa-certificate" aria-hidden="true"></i>
          Enregistrer mes votes
        </button>
      </div>

    </div>
    
    <div class="alert alert-warning" hidden="hidden">
      <p>
        <i class="fa fa-warning"></i> Erreur de communication. 
        Votre vote n'a pas été enregistré.
      </p>
    </div>
    
    <div class="alert alert-success" hidden="hidden">
      <p>
        <i class="fa fa-check"></i> Vote validé
      </p>
    </div>
  </div>


</section>

{{> page-footer this }}

<script type="text/javascript" src="/public/js/FiMaJe-contest-vote.js" ></script>

<script type="text/javascript" >
var FMJVoteSheet;

// Create the main form
$(function() {
    FMJVoteSheet = new FMJContestVoteSheet("{{contest}}", "{{user}}");
});

</script>